<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Methods Tutoring: Linear Algebra</title>

  <meta property="description" itemprop="description" content="Notes on Linear Algebra."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

  <meta name="article:author" content="Alex Stephenson"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Methods Tutoring: Linear Algebra"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Notes on Linear Algebra."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Methods Tutoring"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Methods Tutoring: Linear Algebra"/>
  <meta property="twitter:description" content="Notes on Linear Algebra."/>
  <meta property="twitter:site" content="@adastephenson"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","output"]}},"value":[{"type":"character","attributes":{},"value":["Linear Algebra"]},{"type":"character","attributes":{},"value":["Notes on Linear Algebra.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Alex Stephenson"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","hightlight"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]},{"type":"character","attributes":{},"value":["haddock"]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Linear Algebra","description":"Notes on Linear Algebra.","authors":[{"author":"Alex Stephenson","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Methods Tutoring</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="about.html">Creator</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Lecture Notes
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="causal.html">Causal Inference</a>
<a href="game.html">Game Theory</a>
<a href="linalg.html">Linear Algebra</a>
<a href="ml.html">Machine Learning</a>
<a href="optim.html">Optimization</a>
<a href="prob.html">Probability</a>
<a href="stats.html">Statistics</a>
<a href="survey.html">Survey Design and Sampling</a>
</div>
</div>
<a href="intro-seq.html">Math Camp Solutions</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Coding
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="py-coding.html">Python</a>
<a href="r-coding.html">R</a>
<a href="matrix-code.html">Applied Linear Algebra</a>
</div>
</div>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Linear Algebra</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Notes on Linear Algebra.</p></p>
</div>

<div class="d-byline">
  Alex Stephenson  
  

</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#vectors" id="toc-vectors">Vectors</a>
<ul>
<li><a href="#vector-addition" id="toc-vector-addition">Vector Addition</a></li>
<li><a href="#scalar-vector-multiplication" id="toc-scalar-vector-multiplication">Scalar-vector multiplication</a></li>
<li><a href="#inner-product" id="toc-inner-product">Inner Product</a></li>
</ul></li>
<li><a href="#linear-functions" id="toc-linear-functions">Linear Functions</a>
<ul>
<li><a href="#defining-linear-and-affine-functions" id="toc-defining-linear-and-affine-functions">Defining Linear and Affine Functions</a></li>
<li><a href="#taylor-approximation" id="toc-taylor-approximation">Taylor Approximation</a></li>
<li><a href="#regression-model" id="toc-regression-model">Regression Model</a></li>
</ul></li>
<li><a href="#norm-and-distance" id="toc-norm-and-distance">Norm and distance</a>
<ul>
<li><a href="#distance" id="toc-distance">Distance</a></li>
<li><a href="#standard-deviation" id="toc-standard-deviation">Standard Deviation</a></li>
<li><a href="#angle" id="toc-angle">Angle</a></li>
</ul></li>
<li><a href="#linear-independence" id="toc-linear-independence">Linear Independence</a>
<ul>
<li><a href="#linear-dependence-and-independence" id="toc-linear-dependence-and-independence">Linear Dependence and Independence</a></li>
<li><a href="#basis" id="toc-basis">Basis</a></li>
</ul></li>
<li><a href="#matrices" id="toc-matrices">Matrices</a>
<ul>
<li><a href="#transpose-addition-norm" id="toc-transpose-addition-norm">Transpose, Addition, Norm</a></li>
<li><a href="#matrix-vector-multiplication" id="toc-matrix-vector-multiplication">Matrix-vector Multiplication</a></li>
</ul></li>
<li><a href="#matrix-matrix-multiplication" id="toc-matrix-matrix-multiplication">Matrix-matrix multiplication</a>
<ul>
<li><a href="#properties-of-matrix-multiplication" id="toc-properties-of-matrix-multiplication">Properties of Matrix Multiplication</a></li>
<li><a href="#matrix-power" id="toc-matrix-power">Matrix Power</a></li>
<li><a href="#qr-factorization" id="toc-qr-factorization">QR Factorization</a></li>
</ul></li>
<li><a href="#chapter-11-matrix-inverses" id="toc-chapter-11-matrix-inverses">Chapter 11: Matrix Inverses</a>
<ul>
<li><a href="#inverse" id="toc-inverse">Inverse</a></li>
<li><a href="#solving-linear-equations" id="toc-solving-linear-equations">Solving linear equations</a></li>
</ul></li>
<li><a href="#least-squares" id="toc-least-squares">Least Squares</a>
<ul>
<li><a href="#solving-a-least-squares-problem" id="toc-solving-a-least-squares-problem">Solving a Least Squares Problem</a></li>
</ul></li>
</ul>
</nav>
</div>
<h2 id="vectors">Vectors</h2>
<p>A <em>vector</em> is an ordered list of numbers. Vectors are equal <span class="math inline">\(a = b\)</span> when they have the same size and same corresponding entries. Block (or stacked) vectors are made by concatenating two or more vectors.</p>
<p>Subvectors are made by slicing a vector into sub-elements. Usually colon notation is used <span class="math inline">\(a_{r:s}\)</span> where the subscript is the <em>index range</em>. While most computer languages index starting at 0, R follows standard mathematical notation where vectors are indexed beginning at 1.</p>
<p>Zero vectors are vectors with all elements equal to 0. Unsurprisingly, the Ones vector is a vector with all elements equal to 1.</p>
<p>Sparsity is an attribute of a vector and a vector is said to be sparse if many of its entries are zero. The number of nonzero entries of a n vector is denoted <code>nnz()</code>.</p>
<h3 id="vector-addition">Vector Addition</h3>
<p>Two vectors of the same size can be added together by adding the corresponding elements. This forms a new vector of the same size, called the <em>sum</em> of the vectors. Subtraction is a different form of addition so works the same way.</p>
<h4 id="properties-of-vector-addition">Properties of Vector Addition</h4>
<ol type="1">
<li>Commutative: <span class="math inline">\(a + b = b + a\)</span></li>
<li>Associative: <span class="math inline">\((a + b) + c = a + (b + c) = a + b + c\)</span></li>
<li>Adding the zero vector leads to to no change in the original vector.</li>
<li>Subtracting a vector from itself yields the 0 vector</li>
</ol>
<h3 id="scalar-vector-multiplication">Scalar-vector multiplication</h3>
<p><em>Scalar multiplication</em> is when each element of a vector is multiplied by a scalar. A scalar means a number like 1, 46, or 3/5.</p>
<h4 id="properties">Properties</h4>
<ol type="1">
<li>Commutative: <span class="math inline">\(\alpha a = a\alpha\)</span></li>
<li>Associative: <span class="math inline">\((\beta\gamma)a = \beta(\gamma a)\)</span></li>
<li>If a is a vector, <span class="math inline">\((\beta + \gamma)a = \beta a + \gamma a\)</span></li>
</ol>
<h3 id="inner-product">Inner Product</h3>
<p>The standard <em>inner product</em> (aka dot product) of two n-vectors is defined as the the scalar <span class="math inline">\(a^Tb = a_1b_1 + ... + a_nb_n\)</span> or the sum or the products of corresponding entries.</p>
<h4 id="properties-1">Properties</h4>
<ol type="1">
<li>Commutativity: <span class="math inline">\(a^Tb = b^Ta\)</span>. This means that order does not matter for the arguments in the inner product.</li>
<li>Associatitivy with scalar multiplication: <span class="math inline">\((\gamma a)^Tb = \gamma(a^Tb) = \gamma a^Tb\)</span></li>
<li>Distributivity with vector additions <span class="math inline">\((a + b)^Tc = a^Tc + b^Tc\)</span></li>
<li>Expand the product: <span class="math inline">\((a + b)^T(c+d) = a^Tc + a^Td + b^Tc + b^Td\)</span>. Note that on the left hand side the + means vector addition and on the right the sums means scalar addition.</li>
</ol>
<p>For block vectors, if vectors <em>a</em> and <em>b</em> are block vectors and the corresponding blocks have the same size (theyre conformable) then: <span class="math inline">\(a^Tb = a_1^Tb_1 + ... a_k^Tb_k\)</span></p>
<p>The inner product of the block vectors is the sum of the inner products of the block. An example of where the inner product can be useful is giving the expected value of a quantity.</p>
<h2 id="linear-functions">Linear Functions</h2>
<h3 id="defining-linear-and-affine-functions">Defining Linear and Affine Functions</h3>
<p><span class="math inline">\(f:R^n \rightarrow R\)</span> means that <span class="math inline">\(f\)</span> is a function that maps real n-vectors to real numbers. A function <span class="math inline">\(f:R^n \rightarrow R\)</span> must specify what value <span class="math inline">\(f\)</span> takes for any possible argument <span class="math inline">\(x \in R^n\)</span></p>
<p>If <span class="math inline">\(x\)</span> is an n-vector then <span class="math inline">\(f(x)\)</span> which is a scalar denotes the <em>value</em> of the function <span class="math inline">\(f\)</span> at <span class="math inline">\(x\)</span>.</p>
<p>We can also interpret <span class="math inline">\(f\)</span> as a function of n scalar arguments in which case <span class="math inline">\(f(x) = f(x_1,..., x_n)\)</span>.</p>
<p><strong>The Inner product function</strong>: Suppose <span class="math inline">\(a\)</span> is an n-vector, then the inner product function for any n-vector x is: <span class="math inline">\(f(x) = a^Tx = a_1x_1 +...+a_nx_n\)</span>.</p>
<ul>
<li>We can think of <span class="math inline">\(f\)</span> as a weighted sum of the elements of x where the elements of a give the weights.</li>
<li>Note that if a function is linear then it can be expressed as the inner product of its argument with some fixed vector</li>
</ul>
<p><strong>Superposition and Linearity</strong>: The inner product function satisfies</p>
<p><span class="math display">\[\begin{aligned}
f(\alpha x + \beta y) &amp;= a^T(\alpha x + \beta y) \\
f(\alpha x + \beta y) &amp;= a^T(\alpha x) + a^T(\beta y) \\
f(\alpha x + \beta y) &amp;= \alpha(a^T) + \beta(a^Ty) \\
f(\alpha x + \beta y) &amp;= \alpha f(x) + \beta f(y) \\
\end{aligned}\]</span></p>
<p>for all n-vectors x, y and all scalars <span class="math inline">\(\alpha, \beta\)</span>. This property is called <em>superposition</em>. Any function that has this property is called <em>linear</em>.</p>
<p>Superposition can be broken down into two properties. A function <span class="math inline">\(f: R^n \rightarrow R\)</span> is linear if it satisfies:</p>
<ul>
<li>Homogeneity: For any n-vector x and any scalar <span class="math inline">\(\alpha\)</span> <span class="math inline">\(f(\alpha x) = \alpha f(x)\)</span>.</li>
<li>Additivity: For any n-vectors x, y: <span class="math inline">\(f(x+y) = f(x) + f(y)\)</span></li>
</ul>
<p><strong>Affine Function</strong>: A linear function plus a constant. Formally, a function <span class="math inline">\(f: R^n \rightarrow R\)</span> is affine <span class="math inline">\(iff\)</span> it can be expressed <span class="math inline">\(f(x) = a^Tx + b\)</span> for some n-vector a and scalar b.</p>
<ul>
<li>b is sometimes called the offset</li>
<li>Any affine scalar valued function satisfies the variation on superposition <span class="math inline">\(f(\alpha x + \beta y) = \alpha f(x) + \beta f(y)\)</span> for all n-vectors x,y, and all scalars <span class="math inline">\(\alpha, \beta\)</span> that satisfy <span class="math inline">\(\alpha + \beta = 1\)</span>
<ul>
<li>For linear functions superposition holds for any coefficient pair <span class="math inline">\(\alpha, \beta\)</span></li>
</ul></li>
</ul>
<h3 id="taylor-approximation">Taylor Approximation</h3>
<p><strong>Taylor Approximation</strong>: Suppose that <span class="math inline">\(f: R^n \rightarrow R\)</span> is differentiable (its partial derivatives exist). Let <span class="math inline">\(z\)</span> be an n-vector. The first order <em>Taylor Approximation</em> of <span class="math inline">\(f\)</span> near the point <span class="math inline">\(z\)</span> is the function <span class="math inline">\(\hat{f}(x)\)</span> defined as:</p>
<p><span class="math inline">\(\hat{f}(x) = f(z) + \frac{\partial f}{\partial x_1}(z)(x_1 - z_1) + ... \frac{\partial f}{\partial x_n}(z)(x_n - z_n)\)</span></p>
<ul>
<li>A Taylor approximation is an affine function of x</li>
<li>Compact notation with inner product notation as <span class="math inline">\(\hat{f}(x) = f(z) + \nabla f(z)^T(x-z)\)</span> where <span class="math inline">\(\nabla f(z)\)</span> is the gradient of <span class="math inline">\(f\)</span> as the point z.</li>
<li>With this notation we see that the first term is the constant <span class="math inline">\(f(z)\)</span> which is the value of the function when x = z. The second term is the inner product of the gradient of f at z and the deviation or perturbation of x from z (e.g.x - z)</li>
</ul>
<h3 id="regression-model">Regression Model</h3>
<p>The affine function of x <span class="math inline">\(\hat{y} = x^T\beta + v\)</span> where <span class="math inline">\(\beta\)</span> is an n-vector and <span class="math inline">\(v\)</span> is a scalar is called a <em>regression model</em></p>
<ul>
<li><span class="math inline">\(\beta_i\)</span> is the amount by which <span class="math inline">\(\hat{y}\)</span> changes when feature <span class="math inline">\(i\)</span> increases by 1, holding all other features the same.</li>
<li><span class="math inline">\(v\)</span> is the value of the <span class="math inline">\(\hat{y}\)</span> when all features have value 0</li>
</ul>
<p>We can use vector stacking to put the weights and offset into a single parameter vector.</p>
<p><span class="math inline">\(\hat{y} = x^Tb + v = \begin{bmatrix} 1 \\ x \end{bmatrix}^T \begin{bmatrix} v \\ \beta \end{bmatrix} = \tilde{x}^T\tilde{\beta}\)</span></p>
<p>where the first feature always has the value 1. This constant guarantees an intercept.</p>
<h2 id="norm-and-distance">Norm and distance</h2>
<p><strong>Norm</strong>: The Euclidean norm of an n-vector <em>x</em> denoted <span class="math inline">\(\lVert x \rVert\)</span> is the square root of the sum of the squares of its elements.</p>
<p><span class="math display">\[\begin{aligned}
\lVert x \rVert = \sqrt{x_1^2 + x_2^2 + ... + x_n^2}
\end{aligned}\]</span></p>
<p>As an example <span class="math inline">\(\lVert \begin{bmatrix} 2 \\ -1 \\2 \end{bmatrix} \rVert = \sqrt{9} = 3\)</span></p>
<h5 id="properties-of-norm">Properties of norm</h5>
<ul>
<li>Nonnegative homogeneity. <span class="math inline">\(\lVert\beta x\rVert = \lVert\beta\rVert \lVert x \rVert\)</span>. Multiplying a vector by a scalar multiplies the norm by the absolute value of the scalar.</li>
<li>Triangle inequality. <span class="math inline">\(\lVert x + y \rVert \leq \lVert x \rVert + \lVert y \rVert\)</span>. The norm of a sum of two vectors is no more than the sum of the norms.</li>
<li>Also known as subadditivity.</li>
<li>Nonnegativity. <span class="math inline">\(\lVert x \rVert &gt; 0\)</span>$</li>
<li>Definiteness. <span class="math inline">\(\lVert x \rVert = 0 \iff x = 0\)</span></li>
</ul>
<p><strong>Root Mean Square Value</strong> The norm is related the RMSE value of an n-vector x is defined as <span class="math inline">\(\sqrt{\frac{x_1^2 + ... + x_n^2}{n}} = \frac{\lVert x \lVert}{\sqrt{n}}\)</span></p>
<p><strong>Norm of a sum</strong>. The norm of a sum of two vectors x and y</p>
<p><span class="math display">\[\begin{aligned}
\lVert x + y \lVert ^2 &amp;= (x+y)^T(x+y) \\
\lVert x + y \lVert ^2 &amp;= x^Tx + x^ty + y^Tx + y^Ty \\
\lVert x + y \lVert ^2 &amp;= \lVert x\lVert ^2 + 2x^Ty + \lVert y\lVert ^2 \\
\lVert x + y \lVert  &amp;= \sqrt{\lVert x\lVert ^2 + 2x^Ty + \lVert y\lVert ^2}
\end{aligned}\]</span></p>
<p><strong>Norm of blocked vectors</strong>. For the block vector d = (a,b,c) where a,b,c are vectors.</p>
<p>$(a,b,c)= = (a, b, c) = d$</p>
<p>In words, the norm of a stacked vector is the norm of the vector formed by the norms of the subvectors.</p>
<p><strong>Chebyshevs Inequality</strong>. Suppose that x is an n-vector and that k of its entries satisfy <span class="math inline">\(|x_i| \geq a, a &gt; 0\)</span>. Then k of its entries satisfy <span class="math inline">\(x_i^2 \geq a^2\)</span>.</p>
<p>It follows from this that <span class="math inline">\(\lVert x\lVert ^2 \geq ka^2\)</span> since k of the numbers in the sum are at least <span class="math inline">\(a^2\)</span> and the other n-k numbers are nonnegative.</p>
<p>We conclude from this Chebyshevs Inequality <span class="math inline">\(k \leq \frac{\lVert x\lVert ^2}{a^2}\)</span>. An alternative way to write this is <span class="math inline">\(\frac{k}{n} \leq (\frac{rms(x)}{a})^2\)</span> where k is the number of entries of x with absolute value at least a. The LHS is the fraction of entries of the vector that are at least a in absolute value.</p>
<h3 id="distance">Distance</h3>
<p><strong>Euclidean Distance</strong>: dist(a,b) = $a - b$.</p>
<p>As an example consider the following. <span class="math inline">\(u = \begin{bmatrix} 1.8 \\ 2.0 \\ -3.7 \\ 4.7 \end{bmatrix}\)</span>, <span class="math inline">\(v = \begin{bmatrix} 0.6 \\ 2.1 \\ 1.9 \\ -1.4 \end{bmatrix}\)</span>, <span class="math inline">\(w = \begin{bmatrix} 2.0 \\ 1.9 \\ -4.0 \\ 4.6 \end{bmatrix}\)</span>.</p>
<p>Then, the distances between pairs are <span class="math inline">\(\lVert u - v\lVert = 8.368\)</span>, <span class="math inline">\(\lVert u - w\lVert = 0.387\)</span>, and <span class="math inline">\(\lVert v - w\lVert = 8.533\)</span></p>
<h3 id="standard-deviation">Standard Deviation</h3>
<p><strong>De-meaned vector</strong>: For any vector x, the vector <span class="math inline">\(\tilde{x} = x - avg(x)\textbf{1}\)</span> is the de-meaned vector.</p>
<p><strong>Standard Deviation</strong>: The RMS value of the de-meaned vector. Defined as <span class="math inline">\(\sigma_x = \sqrt{\frac{(x_1 - \bar{x})^2 +...+(x_n - \bar{x})^2}{n}}\)</span>.</p>
<p>We can represent this with inner products as <span class="math inline">\(\sigma_x = \frac{\lVert x - (\textbf{1}^Tx/n)\textbf{1}}{\sqrt{n}}\)</span></p>
<h5 id="properties-of-standard-deviation">Properties of Standard Deviation</h5>
<ul>
<li>Adding a constant to every entry of a vector does not change its standard deviation</li>
<li>Multiplying a vector by a scalar multiplies the standard deviation by the absolut value of the scalar.</li>
</ul>
<p><strong>Standardization</strong> For any de-meaned vector x, dividing by the standard deviation gives us a standardized version of x.</p>
<p><span class="math inline">\(z = \frac{1}{\sigma_x}(x - \mu_x\textbf{1})\)</span></p>
<h3 id="angle">Angle</h3>
<p><strong>Cauchy-Schwarz Inequality</strong>: $|a^Tb| ab$ for any n-vectors a and b.</p>
<p><strong>Angle between vectors</strong>: The angle between two nonzero vectors a, b is defined by <span class="math inline">\(\theta = arccos(\frac{a^Tb}{\lVert a\lVert \lVert b\lVert })\)</span> where arccos denotes the inverse cosine normalized to lie in the interval <span class="math inline">\([0, \pi]\)</span>.</p>
<p>This is equivalent to <span class="math inline">\(\theta\)</span> being the unique number in that interval that satisfies <span class="math inline">\(a^Tb = \lVert a\lVert \lVert b\lVert cos\theta\)</span></p>
<p><strong>Norms of sum via angles</strong>: For vectors x and y:</p>
<p><span class="math inline">\(\lVert x+y\lVert ^2 = \lVert x\lVert ^2 + 2x^Ty + \lVert y\lVert ^2 = \lVert x\lVert ^2 + 2\lVert x\lVert \lVert y\lVert cos\theta + \lVert y\lVert ^2\)</span></p>
<ul>
<li>If x and y are aligned <span class="math inline">\(\theta = 0\)</span> then the norms add.</li>
<li>If x and y are orthogonal, then we have the pythogorean theorem for norms.</li>
</ul>
<p><strong>Correlation Coefficient</strong>: Suppose a and b are vectors and we de-mean them. Assuming the de-meaned vectors are not zero, we define the correlation coefficient as.</p>
<p><span class="math inline">\(\rho = \frac{\tilde{a}^T\tilde{b}}{\lVert \tilde{a}\lVert \lVert \tilde{b}\lVert }\)</span></p>
<p><strong>Standard Deviation of a sum</strong>: <span class="math inline">\(\sigma_{a+b} = \sqrt{\sigma_a^2 + 2\rho\sigma_a\sigma_b + \sigma_b^2}\)</span></p>
<p>Note when a and b are uncorrelated (<span class="math inline">\(\rho = 0\)</span>) then this reduces to the sum of the standard deviations.</p>
<h2 id="linear-independence">Linear Independence</h2>
<h3 id="linear-dependence-and-independence">Linear Dependence and Independence</h3>
<p><strong>Linear Dependence</strong>: A collection of n-vectors <span class="math inline">\(a_1, a_2,..., a_k\)</span> with <span class="math inline">\(k\geq1\)</span> is linearly dependent if <span class="math inline">\(\beta_1a_1 + ... + \beta_ka_k = 0\)</span> holds from some <span class="math inline">\(\beta_1,..., \beta_k\)</span> that are not all zero.</p>
<ul>
<li>When a collection of vectors are linearly dependent, at least one vector can be expressed as a linear combination of the other vectors.</li>
</ul>
<p><strong>Linear Independence</strong> The above definition only holds for when <span class="math inline">\(\beta_1 = \beta_2 = ... = \beta_k = 0\)</span>. E.g. the only linear combination of vectors that equals the zero vector is the linear combination with all coefficients = 0.</p>
<p><strong>Linear Combination of Independent Vectors</strong>: Suppose we have a vector <em>x</em> that is a linear combination of <span class="math inline">\(a_1,..., a_k\)</span>. When the vectors <span class="math inline">\(a_1,...,a_k\)</span> are linearly independent then the coefficients that form x are unique.</p>
<h3 id="basis">Basis</h3>
<p><strong>Independence-dimension inequality</strong>: If n-vectors <span class="math inline">\(a_1,...,a_k\)</span> are linearly independent then <span class="math inline">\(k \leq n\)</span>.</p>
<ul>
<li>In words A linearly independent collection of n-vectors can have at most n elements.</li>
</ul>
<p><strong>Basis</strong>: A collection of linearly independent n-vectors.</p>
<ul>
<li>If the n-vectors <span class="math inline">\(a_1, ..., a_n\)</span> are a basis then any n-vector <span class="math inline">\(b\)</span> can be written as a linear combination of them.</li>
<li>Since we know any linear combination of linearly independent vectors can only be expressed in one way we have the implication that <em>any n-vector <span class="math inline">\(b\)</span> can be written in a unique way as a linear combination of a basis <span class="math inline">\(a_1,...,a_n\)</span></em></li>
</ul>
<h2 id="matrices">Matrices</h2>
<p><strong>Matrix</strong>: a rectangular array of numbers written between brackets. The size of a matrix is the number of columns and the number of rows. For example, a matrix with 3 rows and 4 columns is a 3x4 matrix. In general, a matrix of size m x n is called an m x n matrix.</p>
<p><strong>Square Matrix</strong>: a matrix that has an equal number of rows and columns. <code>mat</code> above is a square matrix.</p>
<p><strong>Zero Matrix</strong>: A matrix with all elements set to zero</p>
<p><strong>Identity Matrix</strong>: A square matrix with diagonal elements equal to 1 and off diagonal elements equal to 0.</p>
<p><strong>Diagonal matrix</strong>: A matrix is diagonal if <span class="math inline">\(A_{ij} = 0, \forall i \neq j\)</span></p>
<p><strong>Triangular Matrix</strong>: A square matrix A is <em>upper triangular</em> if <span class="math inline">\(A_{ij} = 0, i &gt; j\)</span> and is *lower triangular if <span class="math inline">\(A_{ij} = 0, i &lt; j\)</span>.</p>
<ul>
<li>Diagonal matrices are both upper and lower triangular.</li>
</ul>
<h3 id="transpose-addition-norm">Transpose, Addition, Norm</h3>
<p>Like vectors, we can take the transpose of a matrix. Transposing twice returns original matrix.</p>
<p>Two matrices of the same size can be added together. Addition is element-wise.</p>
<p><strong>Properties of Matrix addition</strong></p>
<ul>
<li>Commutativity: A + B = B + A</li>
<li>Associativity: A + (B + C) = (A + B) + C</li>
<li>Addition with Zero matrix: A + 0 = A</li>
<li>Transpose of sum: <span class="math inline">\((A + B)^T = A^T + B^T\)</span></li>
</ul>
<p>Scalar-matrix multiplication is also elementwise and defined similarly as with vectors</p>
<p><strong>Matrix Norm</strong>: The norm of a matrix Ais the square root of the sum of the squares of its entries</p>
<h3 id="matrix-vector-multiplication">Matrix-vector Multiplication</h3>
<p>The matrix vector product y = Ax is the m-vector y with elements <span class="math inline">\(\sum_{k=1}^n A_{ik}x_k\)</span></p>
<p><strong>Linear Dependence of Columns</strong>: The columns of a matrix are linearly dependent (do not have full rank) if <span class="math inline">\(Ax = 0\)</span> for some <span class="math inline">\(x \neq 0\)</span>. The columns of a matrix are linearly independent if <span class="math inline">\(Ax = 0 \implies x = 0\)</span></p>
<p><strong>Properties of matrix-vector multiplication</strong>:</p>
<ul>
<li>multiplication distributes across the vector argument. <span class="math inline">\(A(u + v) = Au + Av\)</span></li>
<li>multiplication distributes across the matrix argument <span class="math inline">\((A + B)u = Au + Bu\)</span></li>
</ul>
<h2 id="matrix-matrix-multiplication">Matrix-matrix multiplication</h2>
<p>It is possible to multiply two matrices with compatible dimensions. Multiplying by the identity matrix will return the original matrix. Note that in general matrix multiplication is not commutative.</p>
<h3 id="properties-of-matrix-multiplication">Properties of Matrix Multiplication</h3>
<ul>
<li><p>Associativity: (AB)C = A(BC). We can write the product as ABC</p></li>
<li><p>Associativity with scalar multiplication: <span class="math inline">\(\gamma(AB)=(\gamma A)B\)</span></p></li>
<li><p>Distributivity with addition: <span class="math inline">\(A(B+C) == (A+B)C = AC + BC\)</span></p></li>
<li><p>Transpose of product: The transpose of a product is the product of the transposes in opposite order <span class="math inline">\((AB)^T = B^T A^T\)</span></p></li>
</ul>
<p>A fact about inner product and matrix-vector products. If A is m x n, x is an n-vector, and y is an m-vector, then <span class="math inline">\(y^T(Ax) = (y^T A)x = (A^Ty)^Tx\)</span>. This means that the inner product of y and Ax is equal to the inner product of x and <span class="math inline">\(A^Ty\)</span></p>
<p><strong>Gram Matrix</strong>: For an m x n matrix A, with columns <span class="math inline">\(a_1,...,a_n\)</span> the matrix product <span class="math inline">\(G= A^TA\)</span>.</p>
<ul>
<li>Note, using the transpose of product rule <span class="math inline">\(G^T = (A^TA)^T = (A^T)(A^T) = A^TA = G\)</span></li>
</ul>
<h3 id="matrix-power">Matrix Power</h3>
<p>If A is a square matrix then we can note <span class="math inline">\(AA = A^2\)</span> and more generally if k and l are positive integers <span class="math inline">\(A^kA^l = A^{k+l}\)</span></p>
<h3 id="qr-factorization">QR Factorization</h3>
<p>With a Gram matrix, we can express the condition that the n-vectors are orthonormal in notation by <span class="math inline">\(A^TA = I\)</span>. A square matrix that satisfies this property is called <strong>orthogonal</strong> and its columns are an orthonormal basis.</p>
<h2 id="chapter-11-matrix-inverses">Chapter 11: Matrix Inverses</h2>
<p><strong>Left Inverse</strong>: A matrix X that satisfies <span class="math inline">\(XA = I\)</span> is called a left inverse of A. The matrix is said to be <em>left invertible</em> if a left inverse exists.</p>
<ul>
<li>If A has a left inverse C then the columns of A are linearly independent. The converse is also true. A matrix has a left inverse iff its columns are linearly independent.</li>
</ul>
<p><strong>Right Inverse</strong>: A matrix A that satisfies <span class="math inline">\(AX = I\)</span> is called a right inverse of A. The matrix is <em>right invertible</em> if a right inverse exists.</p>
<ul>
<li>A matrix is right invertible iff its rows are linearly independent.</li>
<li>Only square or wide matrices can be right invertible</li>
<li>A right inverse can be used to find a solution of a square or underdetermined set of linear equations, for any vector b</li>
</ul>
<h3 id="inverse">Inverse</h3>
<p>If a matrix is left and right invertible then the left and right inverses are unique and equal. When a matrix has both a left and right inverse then it is <em>nonsingular</em></p>
<ul>
<li>Inverible matrices must be square. A matrix A and its inverse (if it exists) satisfies <span class="math inline">\(AA{^-1} = A^{-1}A = I\)</span></li>
<li>The square system of linear equations <span class="math inline">\(Ax = b\)</span> with A invertible has the unique solution <span class="math inline">\(x = A^{-1}b\)</span> for any n-vector b.</li>
</ul>
<p>For a square matrix the following are equivalent:</p>
<ol type="1">
<li>A is invertible</li>
<li>The columns of A are linearly independent</li>
<li>The rows of A are linearly independent</li>
<li>A has a left inverse</li>
<li>A has a right inverse</li>
</ol>
<p>Triangular matrices with nonzero diagonal elements are invertible</p>
<h3 id="solving-linear-equations">Solving linear equations</h3>
<h4 id="back-substitution">Back Substitution</h4>
<p>Given a <span class="math inline">\(n \times n\)</span> upper triangular matrix R with nonzero diagonal entries, and an n-vector <span class="math inline">\(b\)</span>.</p>
<p>For <span class="math inline">\(i = n,...,1\)</span>,
<span class="math inline">\(x_i = (b_i = R{i, {i+1}}x_{i+1}-...-R_{i,{n}}x_n))/R_{ii}\)</span></p>
<p>For lower triangular matrices with non-zero diagonal elements we can solve using forward substitution, which is the reverse of this process.</p>
<h2 id="least-squares">Least Squares</h2>
<p>Suppose that the <span class="math inline">\(m \times n\)</span> matrix A is tall so that system of linear equations <span class="math inline">\(Ax = b\)</span> where <span class="math inline">\(b\)</span> is an m-vector is over-determined. Such an equation only has a solution if <span class="math inline">\(b\)</span> is a linear combination of the columns of A.</p>
<ul>
<li>This rarely happens in practice, so we seek an x for which <span class="math inline">\(r = Ax -b\)</span> is as small as possible. <span class="math inline">\(r = Ax -b\)</span> is referred to as the <em>residual</em></li>
<li>The best way to do this is to minimize the norm of the residual $Ax - b$</li>
</ul>
<p>Minimizing the norm of a residual and the square of a norm are the same problem, so we minimize <span class="math inline">\(\lVert Ax - b\lVert ^2\)</span>.</p>
<p>This approximation is often referred to as <em>linear least squares regression</em></p>
<h3 id="solving-a-least-squares-problem">Solving a Least Squares Problem</h3>
<p>We assume that the columns of A are full rank (e.g.linearly independent)</p>
<h4 id="via-calculus">Via Calculus</h4>
<p>Minimizing <span class="math inline">\(\lVert Ax -b \lVert ^2\)</span> must satsify <span class="math inline">\(\frac{\partial f}{\partial x_i} = 0\)</span>.
We can express this as the vector equation <span class="math inline">\(\nabla f(\hat{x}) = 0\)</span> where the LHS is the gradient of <span class="math inline">\(f\)</span> evaluated at <span class="math inline">\(\hat{x}\)</span>. In matrix form this is <span class="math inline">\(\nabla f(\hat{x}) = 2A^T(Ax-b)\)</span>.</p>
<p>We can verify this is true by deriving that from scratch. The least squares object as a sum is <span class="math inline">\(f(x) = \lVert Ax-b\lVert ^2 = \sum_{i=1}^m (\sum_{j=1}^n A_{ij}x_j - b_i)^2\)</span></p>
<p>Take the partial derivative of <span class="math inline">\(f\)</span> with respect to <span class="math inline">\(x_k\)</span>. Differentiating by terms we get.</p>
<p><span class="math display">\[\begin{aligned}
\nabla f(x)_k &amp;= \frac{\partial f}{\partial x_k}(x) \\
\nabla f(x)_k &amp;= \sum_{i=1}^m 2(\sum_{j=1}^nA_{ij}x_j -b_i)(A_{ik}) \\
\nabla f(x)_k &amp;= \sum_{i=1}^m 2(A^T)_{ki}(Ax-b)_i \\
\nabla f(x)_k &amp;=  (2A^T(Ax-b))_k
\end{aligned}\]</span></p>
<p>Any minimizer of that must be equal to zero which we can write as <span class="math inline">\(A^TA\hat{x} = A^Tb\)</span>. These are the normal equations. Because <span class="math inline">\(A^TA\)</span> is a Gram matrix and we have assumed full rank, it is invertible. This implies.</p>
<p><span class="math inline">\(\hat{x} = (A^TA)^{-1}A^Tb\)</span> is the only solution of the normal equations and is therefore unique.</p>
<h4 id="direct-verification">Direct Verification</h4>
<p>We will directly show the proceeding derivation without calculus by showing that for any <span class="math inline">\(x \neq \hat{x}\)</span> we have <span class="math inline">\(\lVert A\hat{x}-b\lVert ^2 &lt; \lVert Ax-b\lVert ^2\)</span> and that will establish that <span class="math inline">\(\hat{x}\)</span> is the unique vector that minimizes our problem.</p>
<p><span class="math display">\[\begin{aligned}
\lVert Ax-b\lVert ^2 &amp;= \lVert (Ax-A\hat{x}) + (A\hat{x} = b)\lVert ^2 \\
\lVert Ax-b\lVert ^2 &amp;= \lVert Ax-A\hat{x}\lVert ^2 + \lVert A\hat{x} - b\lVert ^2 + 2(Ax - A\hat{x})^T(A\hat{x}-b)\\
\lVert Ax-b\lVert ^2 &amp;= \lVert Ax-A\hat{x}\lVert ^2 + \lVert A\hat{x} - b\lVert ^2 + (x-\hat{x})^TA^T(A\hat{x} - b)\\
\lVert Ax-b\lVert ^2 &amp;= \lVert Ax-A\hat{x}\lVert ^2 + \lVert A\hat{x} - b\lVert ^2 + (x-\hat{x})^T(A^TA\hat{x}-A^Tb) \\
\lVert Ax-b\lVert ^2 &amp;= \lVert Ax-A\hat{x}\lVert ^2 + \lVert A\hat{x} - b\lVert ^2 + (x - \hat{x})^T(A^TA\hat{x}- A^Tb) \\
\lVert Ax-b\lVert ^2 &amp;= \lVert Ax-A\hat{x}\lVert ^2 + \lVert A\hat{x} - b\lVert ^2 + (x-\hat{x})0\\
\lVert Ax-b\lVert ^2 &amp;= \lVert Ax-A\hat{x}\lVert ^2 + \lVert A\hat{x} - b\lVert ^2
\end{aligned}\]</span></p>
<p>Note that we made use of an inequality by plugging in the normal equations to make the 3rd term disappear. We are left with an equation that shows that <span class="math inline">\(\lVert A\hat{x}-b\lVert ^2 \leq \lVert Ax-b\lVert ^2\)</span>. To show unique minimization suppose the equality holds exactly.</p>
<p><span class="math display">\[\begin{aligned}
\lVert A\hat{x}-b\lVert ^2 \leq \lVert Ax-b\lVert ^2 \\
\lVert A(x-\hat{x})\lVert ^2 &amp;= 0 \\
A(x-\hat{x}) &amp;= 0
\end{aligned}\]</span></p>
<p>Since A has linearly independent columns <span class="math inline">\(x -\hat{x} = 0\)</span>. The only <span class="math inline">\(x\)</span> with the equality property is when <span class="math inline">\(x = \hat{x}\)</span></p>
<p><strong>Orthogonality Principle</strong>: The optimal residual is orthogonal to the columns of A and therefore is orthogonal to any linear combination of the columns of A.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/asteves/methods-notes/issues/new">create an issue</a> on the source repository.</p>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/asteves/methods-notes">https://github.com/asteves/methods-notes</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
